FROM node:lts-alpine

ARG DATABASE_URL
ENV DATABASE_URL=$DATABASE_URL

ARG APP_SECRET
ENV APP_SECRET=$APP_SECRET

ARG BACK_PORT
ENV BACK_PORT=$BACK_PORT

ARG FRONTEND_URL
ENV FRONTEND_URL=$FRONTEND_URL

ARG LAB_NAME
ENV LAB_NAME=$LAB_NAME

ARG EMAIL_ADDRESS
ENV EMAIL_ADDRESS=$EMAIL_ADDRESS

ARG EMAIL_APP_KEY
ENV EMAIL_APP_KEY=$EMAIL_APP_KEY

ARG FIRST_USER_NAME
ENV FIRST_USER_NAME=$FIRST_USER_NAME

ARG FIRST_USER_EMAIL
ENV FIRST_USER_EMAIL=$FIRST_USER_EMAIL

ARG FIRST_USER_PASSWORD
ENV FIRST_USER_PASSWORD=$FIRST_USER_PASSWORD

WORKDIR /srcs

RUN apk add --no-cache openssl
COPY package.json package-lock.json ./
RUN npm install

COPY ./ ./

EXPOSE 4000

CMD ["npm", "start"]